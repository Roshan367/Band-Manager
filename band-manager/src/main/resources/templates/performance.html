<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      xmlns="http://www.w3.org/1999/html">
<head>
  <title>Performance Details</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <meta name="_csrf" th:content="${_csrf.token}">
  <meta name="_csrf_header" th:content="${_csrf.headerName}">
</head>
<body class="font-monospace">
<div th:replace="~{fragments/headerForm.html :: header}"></div>

<div class="main-body container mt-5">
  <h1 class="text-center">Performance Details</h1>
  <div th:if="${performance == null}">
    <p>Error: Performance not found!</p>
    <a class="btn btn-primary"
       href="/performance">
      Back to performance
    </a>
  </div>
  <div th:unless="${performance == null}">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Performance Information</h4>
        <p><strong>Performance ID: </strong><span th:text="${performance.id}">1</span> </p>
        <p><strong>Date: </strong><span th:text="${performance.date}">1</span> </p>
        <p><strong>Time: </strong><span th:text="${performance.time}">1</span> </p>
        <p><strong>Location: </strong><span th:text="${performance.location}">1</span> </p>
        <p><strong>Playlist: </strong>
          <ul class="list-group">
            <li class="list-group-item" th:each="music : ${performance.musicSets}">
              <span th:text="${music.title}">Music Title</span>
            </li>
            <li class="list-group-item" th:if="${performance.musicSets.isEmpty()}">
              <span>No playlist associated.</span>
            </li>
          </ul>
        </p>
        <p><strong>Availability: </strong>
          <span th:if="${performanceMember.availability}">Available</span>
          <span th:unless="${performanceMember.availability}">Not Available</span>
        </p>
        <form id="updatePerformanceMemberForm" class="mb-4">
          <div class="form-group">
            <label class="form-check-label" for="availability">Availability</label>
            <input class="form-check-input" type="checkbox" id="availability" name="availability"
                   th:checked="${performanceMember.availability}">
          </div>
          <button type="button" id="updateChildPerformanceMemberButton" class="btn btn-primary mt-2"
                  th:if="${performanceMember.user.getParentRelationship() != null}"
                  th:data-id="${performanceMember.performanceMemberId.userId} + '_' +
                        ${performanceMember.performanceMemberId.bandId} + '_' + ${performance.id}">
            Update Availability
          </button>
          <button type="button" id="updatePerformanceMemberButton" class="btn btn-primary mt-2"
                  th:unless="${performanceMember.user.getParentRelationship() != null}"
                  th:data-id="${performanceMember.performanceMemberId.userId} + '_' +
                        ${performanceMember.performanceMemberId.bandId} + '_' + ${performance.id}">
            Update Availability
          </button>
        </form>
        <a class="btn btn-primary"
           th:if="${performanceMember.user.getParentRelationship() != null}"
           th:href="@{/child/{childId}/performance(childId=${performanceMember.user.id})}">
          Back to performance
        </a>

        <a class="btn btn-primary"
           th:unless="${performanceMember.user.getParentRelationship() != null}"
           href="/performance">
          Back to performance
        </a>
      </div>
    </div>
  </div>
</div>

<div th:replace="~{fragments/footer.html :: footer}"></div>

<script th:src="@{/js/performance.js}"></script>
</body>
</html>
