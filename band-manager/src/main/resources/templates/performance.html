<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      xmlns="http://www.w3.org/1999/html">
<head>
  <title>Performance Details</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <meta name="_csrf" th:content="${_csrf.token}">
  <meta name="_csrf_header" th:content="${_csrf.headerName}">
</head>
<body class="font-monospace">
<div th:replace="~{fragments/headerForm.html :: header}"></div>

<div class="main-body container mt-5">
  <h1>Performance Details</h1>
  <div th:if="${performance == null}">
    <p>Error: Performance not found!</p>
    <a class="btn btn-outline-dark"
       href="/performance">
      Back to performance
    </a>
  </div>
  <div th:unless="${performance == null}">
    <div class="card border border-dark">
      <div class="card-body">
        <p>Performance ID: <span th:text="${performance.id}">1</span> </p>
        <p>Date: <span th:text="${performance.date}">1</span> </p>
        <p>Time: <span th:text="${performance.time}">1</span> </p>
        <p>Location: <span th:text="${performance.location}">1</span> </p>
        <p>Playlist: 
          <ul class="list-group">
            <li class="list-group-item" th:each="music : ${performance.musicSets}">
              <span th:text="${music.title}">Music Title</span>
            </li>
            <li class="list-group-item" th:if="${performance.musicSets.isEmpty()}">
              <span>No playlist associated.</span>
            </li>
          </ul>
        </p>
        <p>Availability:
          <span th:if="${performanceMember.availability}">Available</span>
          <span th:unless="${performanceMember.availability}">Not Available</span>
        </p>
        
        <form id="updatePerformanceMemberForm">
          <div class="form-group">
            <label class="form-check-label pb-2" for="availability">Availability</label>
            <input class="form-check-input" type="checkbox" id="availability" name="availability"
                   th:checked="${performanceMember.availability}">
          </div>
          <div class="d-flex justify-content-between">

          <button type="button" id="updateChildPerformanceMemberButton" class="btn btn-outline-dark"
                  th:if="${performanceMember.user.getParentRelationship() != null}"
                  th:data-id="${performanceMember.performanceMemberId.userId} + '_' +
                        ${performanceMember.performanceMemberId.bandId} + '_' + ${performance.id}">
            Update Availability
          </button>
          <button type="button" id="updatePerformanceMemberButton" class="btn btn-outline-dark"
                  th:unless="${performanceMember.user.getParentRelationship() != null}"
                  th:data-id="${performanceMember.performanceMemberId.userId} + '_' +
                        ${performanceMember.performanceMemberId.bandId} + '_' + ${performance.id}">
            Update Availability
          </button>
          <a class="btn btn-outline-dark"
          th:if="${performanceMember.user.getParentRelationship() != null}"
          th:href="@{/child/{childId}/performance(childId=${performanceMember.user.id})}">
          Back to performance
          </a>

          <a class="btn btn-outline-dark"
          th:unless="${performanceMember.user.getParentRelationship() != null}"
          href="/performance">
          Back to performance
          </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div th:replace="~{fragments/footer.html :: footer}"></div>

<script th:src="@{/js/performance.js}"></script>
</body>
</html>
